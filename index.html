<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Учебный Хаб 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    borderRadius: {
                        '3xl': '1.5rem',
                        '4xl': '2rem',
                        '5xl': '2.5rem',
                    }
                }
            },
            safelist: [
                'bg-blue-500', 'bg-orange-500', 'bg-purple-500', 'bg-slate-500',
                'bg-blue-600', 'bg-orange-600', 'bg-purple-600',
                'from-blue-400', 'to-blue-600', 'from-orange-400', 'to-orange-600', 'from-purple-400', 'to-purple-600',
                'bg-blue-100', 'bg-orange-100', 'bg-purple-100'
            ]
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        body {
            background-color: #f1f5f9;
            font-family: 'Inter', sans-serif;
            color: #0f172a;
            -webkit-tap-highlight-color: transparent;
            padding-top: max(1rem, env(safe-area-inset-top));
            padding-bottom: max(2rem, env(safe-area-inset-bottom));
        }

        /* Плавная анимация шкалы */
        .progress-bar-smooth {
            transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .current-day-active {
            outline: 3px solid #3b82f6;
            outline-offset: 2px;
        }

        .custom-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }

        @keyframes check-pop {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .animate-pop { animation: check-pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    </style>
</head>
<body class="px-4 md:px-8">
    <div id="app" class="max-w-6xl mx-auto">
        
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 fade-in-up">
            <div>
                <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight text-slate-900">Мой 2026 Год</h1>
                <div class="flex items-center gap-2 mt-2">
                    <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                    <p id="today-display" class="text-xs font-bold text-slate-500 uppercase tracking-widest"></p>
                </div>
            </div>
            <div class="flex bg-white/50 p-1 rounded-2xl border border-slate-200 shadow-sm w-full md:w-auto">
                <button onclick="changeStudyWeek(-1)" class="p-3 hover:bg-white rounded-xl transition-all text-slate-600 active:scale-90">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                </button>
                <div class="px-4 md:px-6 flex flex-col justify-center items-center flex-grow md:min-w-[180px]">
                    <span id="week-date-range" class="text-base md:text-lg font-extrabold text-blue-600 whitespace-nowrap">2 — 8 Февраля</span>
                    <span id="study-week-num" class="text-[9px] font-black uppercase text-slate-400">Неделя обучения</span>
                </div>
                <button onclick="changeStudyWeek(1)" class="p-3 hover:bg-white rounded-xl transition-all text-slate-600 active:scale-90">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                </button>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Sidebar (Habits) -->
            <aside class="lg:col-span-4 space-y-8 order-1 fade-in-up" style="animation-delay: 0.1s">
                <section class="bg-white rounded-5xl p-6 md:p-8 shadow-sm border border-slate-100">
                    <div class="flex justify-between items-center mb-8">
                        <div>
                            <h2 class="text-xl font-black text-slate-900 uppercase tracking-tight">Привычки</h2>
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">Трекер дня</p>
                        </div>
                        <button onclick="openHabitModal()" class="bg-slate-900 text-white p-3 rounded-2xl hover:scale-105 transition-transform active:scale-95">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 4v16m8-8H4" stroke-width="3" stroke-linecap="round"></path></svg>
                        </button>
                    </div>

                    <div id="habits-list" class="space-y-10"></div>

                    <div class="mt-12 pt-8 border-t border-slate-100">
                        <div class="flex justify-between items-end mb-3">
                            <span class="text-[10px] font-black uppercase text-slate-500">Общий прогресс</span>
                            <span id="habit-progress-text" class="text-lg font-black text-blue-600">0%</span>
                        </div>
                        <div class="w-full bg-slate-100 h-3 rounded-full overflow-hidden">
                            <div id="habit-progress-bar" class="bg-blue-600 h-full progress-bar-smooth shadow-sm" style="width: 0%"></div>
                        </div>
                    </div>
                </section>
            </aside>

            <!-- Main Schedule -->
            <main class="lg:col-span-8 order-2">
                <div id="schedule" class="grid grid-cols-1 gap-6"></div>
            </main>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="fixed inset-0 bg-slate-900/40 hidden items-center justify-center p-4 z-[100] backdrop-blur-sm transition-all">
        <div class="bg-white w-full max-w-xl rounded-5xl p-6 md:p-10 custom-shadow scale-95 transition-transform">
            <div class="flex justify-between items-start mb-8">
                <div>
                    <h2 id="modalDayTitle" class="text-2xl md:text-3xl font-black text-slate-900">День</h2>
                    <p class="text-xs font-bold text-slate-400 uppercase mt-1">Редактирование</p>
                </div>
                <button onclick="closeModal()" class="text-slate-300 hover:text-slate-900 transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="2.5" stroke-linecap="round"></path></svg>
                </button>
            </div>
            <div id="modalTasksList" class="space-y-4 max-h-[45vh] overflow-y-auto no-scrollbar mb-8 pr-1"></div>
            <div class="grid grid-cols-2 gap-4">
                <button onclick="addNewTaskToModal()" class="bg-slate-100 text-slate-900 font-bold py-4 md:py-5 rounded-3xl hover:bg-slate-200 transition-all">Добавить</button>
                <button onclick="saveModalChanges()" class="bg-blue-600 text-white font-bold py-4 md:py-5 rounded-3xl shadow-xl shadow-blue-100 hover:bg-blue-700 transition-all">Готово</button>
            </div>
        </div>
    </div>

    <!-- Habit Manager Modal -->
    <div id="habitModal" class="fixed inset-0 bg-slate-900/40 hidden items-center justify-center p-4 z-[100] backdrop-blur-sm">
        <div class="bg-white w-full max-w-md rounded-5xl p-8 md:p-10 custom-shadow">
            <h2 class="text-2xl md:text-3xl font-black text-slate-900 mb-8">Привычки</h2>
            <div id="modalHabitList" class="space-y-3 mb-8 max-h-[40vh] overflow-y-auto no-scrollbar"></div>
            <div class="bg-slate-50 p-2 rounded-3xl flex gap-2 mb-6">
                <input id="newHabitInput" type="text" placeholder="Новая цель..." class="flex-grow bg-transparent px-4 py-3 text-sm font-bold outline-none">
                <button onclick="addNewHabit()" class="bg-blue-600 text-white p-3 rounded-2xl active:scale-90 transition-transform">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 4v16m8-8H4" stroke-width="3"></path></svg>
                </button>
            </div>
            <button onclick="closeHabitModal()" class="w-full text-slate-400 font-bold py-2">Закрыть</button>
        </div>
    </div>

    <script>
        // Начало календаря: 2 Февраля 2026 (Понедельник)
        const CALENDAR_START = new Date(2026, 1, 2); 
        const DAYS_SHORT = ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'];
        const MONTHS_RU = ['Января', 'Февраля', 'Марта', 'Апреля', 'Мая', 'Июня', 'Июля', 'Августа', 'Сентября', 'Октября', 'Ноября', 'Декабря'];

        const defaultSchedule = [
            { day: "Понедельник", tasks: [{ id: "m1", startTime: "19:00", endTime: "21:30", subject: "Русский язык" }] },
            { day: "Вторник", tasks: [{ id: "t1", startTime: "16:00", endTime: "17:00", subject: "Математика" }, { id: "t2", startTime: "18:30", endTime: "21:30", subject: "Информатика" }]},
            { day: "Среда", tasks: [{ id: "w1", startTime: "16:00", endTime: "18:00", subject: "Русский язык" }, { id: "w2", startTime: "18:30", endTime: "21:30", subject: "Математика" }]},
            { day: "Четверг", tasks: [{ id: "th1", startTime: "19:00", endTime: "21:30", subject: "Информатика" }] },
            { day: "Пятница", tasks: [{ id: "f1", startTime: "15:00", endTime: "17:00", subject: "Русский язык" }, { id: "f2", startTime: "18:30", endTime: "21:30", subject: "Математика" }]},
            { day: "Суббота", tasks: [{ id: "s1", startTime: "18:00", endTime: "20:00", subject: "Информатика" }] },
            { day: "Воскресенье", tasks: [{ id: "su1", startTime: "18:00", endTime: "20:00", subject: "Математика" }] }
        ];

        let scheduleData = JSON.parse(localStorage.getItem('study2026_schedule')) || defaultSchedule;
        let userData = JSON.parse(localStorage.getItem('study2026_userdata')) || {};
        let habitList = JSON.parse(localStorage.getItem('study2026_habits')) || [{id: 'h1', name: 'Утренняя зарядка'}, {id: 'h2', name: 'Чтение'}];
        
        let currentWeek = 1;
        let editingDayIndex = null;

        const subjectConfig = {
            "Русский язык": { color: "blue" },
            "Математика": { color: "orange" },
            "Информатика": { color: "purple" },
            "default": { color: "slate" }
        };

        function calculateDuration(start, end) {
            const [sh, sm] = start.split(':').map(Number);
            const [eh, em] = end.split(':').map(Number);
            return (eh * 60 + em - (sh * 60 + sm)) / 60;
        }

        function getDateForWeek(week, dayIdx) {
            const d = new Date(CALENDAR_START);
            d.setDate(d.getDate() + (week - 1) * 7 + dayIdx);
            return d;
        }

        function calculateSubjectStats() {
            const stats = {};
            scheduleData.forEach((day) => {
                day.tasks.forEach(t => {
                    const dur = calculateDuration(t.startTime, t.endTime);
                    if (!stats[t.subject]) stats[t.subject] = { total: 0, done: 0 };
                    stats[t.subject].total += dur;
                    if (userData[`task_${currentWeek}_${t.id}`]) stats[t.subject].done += dur;
                });
            });
            return stats;
        }

        function init() {
            const today = new Date();
            const diff = today - CALENDAR_START;
            const weekNum = Math.ceil((diff + 1) / (7 * 24 * 60 * 60 * 1000));
            currentWeek = Math.max(1, Math.min(12, weekNum));
            
            document.getElementById('today-display').textContent = today.toLocaleDateString('ru-RU', { 
                day: 'numeric', month: 'long', year: 'numeric'
            });
            
            renderAll();
        }

        function renderAll() {
            updateWeekRange();
            renderHabits();
            renderSchedule();
        }

        function updateWeekRange() {
            const start = getDateForWeek(currentWeek, 0);
            const end = getDateForWeek(currentWeek, 6);
            
            let rangeText = `${start.getDate()}`;
            if (start.getMonth() !== end.getMonth()) {
                rangeText += ` ${MONTHS_RU[start.getMonth()]}`;
            }
            rangeText += ` — ${end.getDate()} ${MONTHS_RU[end.getMonth()]}`;
            
            document.getElementById('week-date-range').textContent = rangeText;
            document.getElementById('study-week-num').textContent = `Неделя обучения ${currentWeek}`;
        }

        function renderHabits() {
            const container = document.getElementById('habits-list');
            container.innerHTML = '';
            let doneTotal = 0;

            habitList.forEach(habit => {
                let dots = '';
                for (let i = 0; i < 7; i++) {
                    const d = getDateForWeek(currentWeek, i);
                    const dk = d.toISOString().split('T')[0];
                    const isDone = userData[`hbt_${dk}_${habit.id}`];
                    if (isDone) doneTotal++;

                    dots += `
                        <div class="flex flex-col items-center gap-1.5">
                            <span class="text-[8px] font-black text-slate-300 uppercase">${DAYS_SHORT[i]}</span>
                            <button onclick="toggleHabit('${dk}', '${habit.id}')" 
                                    class="w-8 h-8 md:w-10 md:h-10 rounded-xl md:rounded-2xl border-2 transition-all flex items-center justify-center active:scale-90
                                    ${isDone ? 'bg-blue-600 border-blue-600 shadow-lg animate-pop' : 'border-slate-100 bg-slate-50'}">
                                ${isDone ? '<svg class="w-4 h-4 md:w-5 md:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="4"><path d="M5 13l4 4L19 7"></path></svg>' : ''}
                            </button>
                            <span class="text-[9px] font-bold text-slate-400">${d.getDate()}</span>
                        </div>
                    `;
                }
                const div = document.createElement('div');
                div.innerHTML = `<p class="text-[10px] md:text-[11px] font-black uppercase text-slate-800 mb-4 px-1">${habit.name}</p><div class="flex justify-between items-center">${dots}</div>`;
                container.appendChild(div);
            });

            const pct = (habitList.length * 7) > 0 ? Math.round((doneTotal / (habitList.length * 7)) * 100) : 0;
            document.getElementById('habit-progress-text').textContent = `${pct}%`;
            document.getElementById('habit-progress-bar').style.width = `${pct}%`;
        }

        function renderSchedule() {
            const container = document.getElementById('schedule');
            container.innerHTML = '';
            const subStats = calculateSubjectStats();
            const todayStr = new Date().toISOString().split('T')[0];

            scheduleData.forEach((day, idx) => {
                const dateObj = getDateForWeek(currentWeek, idx);
                const dk = dateObj.toISOString().split('T')[0];
                const isToday = dk === todayStr;
                
                let tasksHtml = '';
                day.tasks.forEach(t => {
                    const isD = userData[`task_${currentWeek}_${t.id}`];
                    const cfg = subjectConfig[t.subject] || subjectConfig.default;
                    const duration = calculateDuration(t.startTime, t.endTime);
                    const sData = subStats[t.subject] || {done:0, total:1};
                    const subPct = Math.min((sData.done / sData.total) * 100, 100);
                    
                    tasksHtml += `
                        <div onclick="toggleTask('${t.id}')" class="group relative flex flex-col p-5 md:p-6 cursor-pointer transition-all hover:bg-slate-50/80 active:bg-slate-100">
                            <div class="flex items-center mb-4">
                                <div class="w-10 h-10 md:w-12 md:h-12 rounded-xl md:rounded-2xl border-2 mr-4 md:mr-5 flex items-center justify-center flex-shrink-0 transition-all
                                    ${isD ? `bg-${cfg.color}-500 border-${cfg.color}-500 shadow-lg animate-pop` : 'border-slate-200'}">
                                    ${isD ? '<svg class="w-5 h-5 md:w-6 md:h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="3"><path d="M5 13l4 4L19 7"></path></svg>' : ''}
                                </div>
                                <div class="flex-grow flex justify-between items-center">
                                    <div>
                                        <div class="font-bold text-sm md:text-base text-slate-900 ${isD ? 'line-through opacity-30 text-slate-400' : ''}">${t.subject}</div>
                                        <div class="text-[9px] md:text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1">
                                            ${t.startTime} — ${t.endTime} <span class="ml-1 opacity-60">| ${duration.toFixed(1)}ч</span>
                                        </div>
                                    </div>
                                    <div class="bg-${cfg.color}-50 text-${cfg.color}-600 text-[8px] md:text-[10px] font-black px-2 md:px-3 py-1 rounded-lg md:rounded-xl uppercase">Урок</div>
                                </div>
                            </div>
                            <div class="pl-[56px] md:pl-[68px]">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-[8px] md:text-[9px] font-black uppercase text-slate-400">Недельный прогресс предмета</span>
                                    <span class="text-[8px] md:text-[9px] font-black text-${cfg.color}-600">${Math.round(subPct)}%</span>
                                </div>
                                <div class="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden">
                                    <div class="h-full bg-${cfg.color}-500 progress-bar-smooth shadow-sm" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                const dayCard = document.createElement('div');
                dayCard.className = `bg-white rounded-5xl border overflow-hidden transition-all fade-in-up ${isToday ? 'current-day-active shadow-2xl scale-[1.01]' : 'border-slate-100 shadow-sm'}`;
                dayCard.style.animationDelay = `${idx * 0.05}s`;
                dayCard.innerHTML = `
                    <div class="px-6 md:px-8 py-4 md:py-5 flex justify-between items-center border-b border-slate-50 ${isToday ? 'bg-blue-50/30' : 'bg-white'}">
                        <div class="flex gap-3 md:gap-4 items-center">
                            <div class="w-10 h-10 md:w-12 md:h-12 rounded-xl md:rounded-2xl bg-slate-900 flex flex-col items-center justify-center text-white">
                                <span class="text-[8px] font-black uppercase text-slate-400">${DAYS_SHORT[idx]}</span>
                                <span class="text-base md:text-lg font-extrabold leading-none">${dateObj.getDate()}</span>
                            </div>
                            <div>
                                <span class="text-xs md:text-sm font-black text-slate-900 uppercase tracking-tight">${day.day}</span>
                                <p class="text-[9px] md:text-[10px] font-bold text-slate-400 uppercase tracking-widest">${MONTHS_RU[dateObj.getMonth()]}</p>
                            </div>
                        </div>
                        <button onclick="event.stopPropagation(); openEditModal(${idx})" class="w-9 h-9 md:w-10 md:h-10 rounded-xl bg-slate-50 text-slate-400 hover:bg-slate-900 hover:text-white transition-all flex items-center justify-center active:scale-90">
                            <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" stroke-width="2"></path></svg>
                        </button>
                    </div>
                    <div class="divide-y divide-slate-50">${tasksHtml || '<p class="p-8 md:p-10 text-center text-slate-300 text-[9px] md:text-[10px] font-black uppercase tracking-[0.2em]">План пуст</p>'}</div>
                `;
                container.appendChild(dayCard);

                // Запускаем анимацию шкал после рендера карточки
                setTimeout(() => {
                    const bars = dayCard.querySelectorAll('.progress-bar-smooth');
                    day.tasks.forEach((t, tidx) => {
                        const sData = subStats[t.subject] || {done:0, total:1};
                        const subPct = Math.min((sData.done / sData.total) * 100, 100);
                        if (bars[tidx]) bars[tidx].style.width = `${subPct}%`;
                    });
                }, 50);
            });
        }

        function toggleTask(id) {
            const key = `task_${currentWeek}_${id}`;
            userData[key] = !userData[key];
            save(); renderAll();
        }

        function toggleHabit(dateKey, id) {
            const key = `hbt_${dateKey}_${id}`;
            userData[key] = !userData[key];
            save(); renderHabits();
        }

        function save() { localStorage.setItem('study2026_userdata', JSON.stringify(userData)); }

        function changeStudyWeek(d) {
            currentWeek = Math.max(1, Math.min(12, currentWeek + d));
            renderAll();
        }

        function openEditModal(i) {
            editingDayIndex = i;
            document.getElementById('modalDayTitle').textContent = scheduleData[i].day;
            const modal = document.getElementById('editModal');
            modal.style.display = 'flex';
            setTimeout(() => modal.firstElementChild.classList.remove('scale-95'), 10);
            renderModalTasks();
        }

        function closeModal() { 
            const modal = document.getElementById('editModal');
            modal.firstElementChild.classList.add('scale-95');
            setTimeout(() => modal.style.display = 'none', 200);
        }

        function renderModalTasks() {
            const list = document.getElementById('modalTasksList');
            list.innerHTML = '';
            scheduleData[editingDayIndex].tasks.forEach((t, i) => {
                const div = document.createElement('div');
                div.className = 'bg-slate-50 p-4 md:p-6 rounded-3xl md:rounded-4xl space-y-4 border border-slate-100 mb-4';
                div.innerHTML = `
                    <div class="flex gap-2">
                        <select class="flex-grow bg-white rounded-xl md:rounded-2xl p-3 md:p-4 text-xs md:text-sm font-bold border border-slate-200 outline-none" onchange="scheduleData[${editingDayIndex}].tasks[${i}].subject=this.value">
                            <option value="Математика" ${t.subject === 'Математика' ? 'selected' : ''}>Математика</option>
                            <option value="Русский язык" ${t.subject === 'Русский язык' ? 'selected' : ''}>Русский язык</option>
                            <option value="Информатика" ${t.subject === 'Информатика' ? 'selected' : ''}>Информатика</option>
                        </select>
                        <button onclick="scheduleData[${editingDayIndex}].tasks.splice(${i},1);renderModalTasks()" class="bg-white text-red-500 w-12 h-12 md:w-14 md:h-14 rounded-xl md:rounded-2xl flex items-center justify-center border border-slate-200">×</button>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <input type="time" value="${t.startTime}" class="bg-white rounded-xl md:rounded-2xl p-3 md:p-4 text-xs md:text-sm font-bold border border-slate-200" onchange="scheduleData[${editingDayIndex}].tasks[${i}].startTime=this.value">
                        <input type="time" value="${t.endTime}" class="bg-white rounded-xl md:rounded-2xl p-3 md:p-4 text-xs md:text-sm font-bold border border-slate-200" onchange="scheduleData[${editingDayIndex}].tasks[${i}].endTime=this.value">
                    </div>
                `;
                list.appendChild(div);
            });
        }

        function addNewTaskToModal() {
            scheduleData[editingDayIndex].tasks.push({ id: 't'+Date.now(), startTime: '18:00', endTime: '20:00', subject: 'Математика' });
            renderModalTasks();
        }

        function saveModalChanges() {
            localStorage.setItem('study2026_schedule', JSON.stringify(scheduleData));
            closeModal(); renderAll();
        }

        function openHabitModal() { document.getElementById('habitModal').style.display = 'flex'; renderHabitManager(); }
        function closeHabitModal() { document.getElementById('habitModal').style.display = 'none'; }

        function renderHabitManager() {
            const list = document.getElementById('modalHabitList');
            list.innerHTML = '';
            habitList.forEach((h, i) => {
                const div = document.createElement('div');
                div.className = "flex items-center justify-between bg-slate-50 p-4 rounded-2xl border border-slate-100";
                div.innerHTML = `<span class="font-bold text-slate-800 text-sm">${h.name}</span><button onclick="habitList.splice(${i},1);renderHabitManager();renderHabits()" class="text-red-400 font-bold p-2 px-3 bg-white rounded-lg text-xs">Удалить</button>`;
                list.appendChild(div);
            });
            localStorage.setItem('study2026_habits', JSON.stringify(habitList));
        }

        function addNewHabit() {
            const input = document.getElementById('newHabitInput');
            if (input.value) {
                habitList.push({ id: 'h'+Date.now(), name: input.value });
                input.value = '';
                renderHabitManager(); renderHabits();
            }
        }

        window.onload = init;
    </script>
</body>
</html>
